{% extends 'base.html' %}
{% load static %}
{% block title %}Subscribe â€“ FitLife Hub{% endblock %}
{% block content %}
<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <h2 class="mb-4 fw-bold text-center">Subscribe to {{ plan.name }}</h2>
      <div class="card shadow-sm border-0">
        <div class="card-body">
          <form id="subscription-form" method="post" novalidate>
            {% csrf_token %}
            {% for field in form %}
              <div class="mb-3">
                <label for="{{ field.id_for_label }}" class="form-label fw-semibold">{{ field.label }}</label>
                {{ field }}
                {% if field.errors %}
                  <div class="text-danger small mt-1">
                    {{ field.errors|striptags }}
                  </div>
                {% endif %}
              </div>
            {% endfor %}
            <div class="mb-3">
              <label class="form-label fw-semibold">Card Details</label>
              <div id="card-element" class="form-control"></div>
              <div id="card-errors" class="text-danger mt-2"></div>
            </div>
            <button type="submit" class="btn btn-primary btn-lg w-100 mt-3" id="pay-btn">
              <span id="pay-btn-text">Subscribe &amp; Pay</span>
              <span id="pay-btn-spinner" class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  const STRIPE_PUBLIC_KEY = "{{ STRIPE_PUBLIC_KEY }}";
  const CREATE_SUBSCRIPTION_URL = "{% url 'subscriptions:create_subscription' plan.id %}";
</script>
<script src="https://js.stripe.com/v3/"></script>
<script src="{% static 'js/subscription_checkout.js' %}"></script>
{% endblock %}